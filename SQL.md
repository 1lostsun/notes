## SQL команды:

| Команда / Инструкция                                                     | Объяснение                                                     | Применение                                                                                                              |
| ------------------------------------------------------------------------ | -------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| `{sql} CREATE DATABASE name;`                                            | Создает новую базу данных.                                     | Инициализация новой БД проекта.                                                                                         |
| `{sql} DROP DATABASE name;`                                              | Удаляет базу данных.                                           | Полное удаление БД. <br>(**Осторожно!**)                                                                                |
| `{sql} CREATE TABLE table_name (...);`                                   | Создает таблицу с указанными колонками и типами.               | Создание структуры данных.                                                                                              |
| `{sql} DROP TABLE table_name;`                                           | Удаляет таблицу.                                               | Очистка ненужной таблицы.                                                                                               |
| `{sql} ALTER TABLE table_name ADD column_name TYPE;`                     | Добавляет новый столбец.                                       | Расширение структуры таблицы.                                                                                           |
| `{sql} ALTER TABLE table_name DROP COLUMN column_name;`                  | Удаляет столбец.                                               | Изменение структуры.                                                                                                    |
| `{sql} ALTER TABLE table_name RENAME TO new_name;`                       | Переименовывает таблицу.                                       | Рефакторинг схемы.                                                                                                      |
| `{sql} ALTER TABLE table_name ALTER COLUMN col TYPE new_type;`           | Меняет тип данных столбца.                                     | Обновление структуры под новые данные.                                                                                  |
| `{sql} TRUNCATE TABLE table_name;`                                       | Удаляет все строки без журналирования.                         | Быстрая очистка таблицы.                                                                                                |
| `{sql} INSERT INTO table_name (col1, col2) VALUES (v1, v2);`             | Вставляет данные.                                              | Добавление новой записи.                                                                                                |
| `{sql} INSERT INTO table_name SELECT ...;`                               | Вставляет результаты другого запроса.                          | Массовое копирование данных.                                                                                            |
| `{sql} UPDATE table_name SET col = value WHERE condtion;`                | Обновляет данные.                                              | Изменение значений в строках.                                                                                           |
| `{sql} DELETE FROM table_name WHERE condition;`                          | Удаляет строки из таблицы.                                     | Очистка данных по условию.                                                                                              |
| `{sql} SELECT * FROM table_name;`                                        | Извлекает все данные из таблицы.                               | Основная операция чтения.                                                                                               |
| `{sql} SELECT col1, col2 FROM table_name;`                               | Извлекает конкретные столбцы из таблицы.                       | Оптимизация запроса.                                                                                                    |
| `{sql} SELECT DISTINCT col FROM table_name;`                             | Убирает дубликаты.                                             | Получение уникальных значений.                                                                                          |
| `{sql} WHERE;`                                                           | Условие фильтрации.                                            | Отбор строк по критерию.                                                                                                |
| `{sql} AND / OR / NOT;`                                                  | Логические операторы.                                          | Сложные условия (`{sql} WHERE age > 10 AND active = true`)                                                              |
| `{sql} ORDER BY col ASC / DESC;`                                         | Сортировка результата.                                         | Упорядочить вывод. <br>`{sql} ASC` - по возрастанию, <br>`{sql} DESC` - по убыванию.                                    |
| `{sql} LIMIT n / OFFSET n;`                                              | Ограничивает количество строк / пропускает первые N строк.     | Постраничный вывод (pagination).                                                                                        |
| `{sql} BETWEEN a AND b;`                                                 | Проверка диапазона.                                            | Например, `{sql} WHERE price BETWEEN 100 AND 500;`                                                                      |
| `{sql} IN (v1, v2, v3);`                                                 | Проверка на совпадение в списке.                               | Альтернатива множественным `{sql} OR`.                                                                                  |
| `{sql} LIKE '%text%';`                                                   | Поиск по шаблону.                                              | Фильтрация по подстроке.                                                                                                |
| `{sql} ILIKE '%text%';`                                                  | Поиск без учета регистра (PostgreSQL).                         | Case-insensitive фильтр (фильтр без учет регистра).                                                                     |
| `{sql} IS NULL / IS NOT NULL;`                                           | Проверка на пустое значение.                                   | Проверка отсутствия данных.                                                                                             |
| `{sql} GROUP BY col;`                                                    | Группирует строки по столбцу.                                  | Подсчет агрегатов (`{sql} SUM(), COUNT(), AVG() и т.д.`).                                                               |
| `{sql} HAVING;`                                                          | Фильтрует результаты группировки.                              | Как `{sql} WHERE`, но для агрегатов.                                                                                    |
| `{sql} COUNT(col);`                                                      | Подсчет строк.                                                 | Количество записей.                                                                                                     |
| `{sql} SUM(col);`                                                        | Сумма значений.                                                | Итоговые данные.                                                                                                        |
| `{sql} AVG(col);`                                                        | Среднее значение.                                              | Статистика.                                                                                                             |
| `{sql} MIN(col) / MAX(col);`                                             | Минимум / максимум.                                            | Анализ диапазонов.                                                                                                      |
| `{sql} AS alias;`                                                        | Псевдоним для таблицы или колонки.                             | Упрощение и читаемость запросов.                                                                                        |
| `{sql} JOIN;`                                                            | Объединяет таблицы по условию.                                 | Свзяь данных из разных таблиц.                                                                                          |
| `{sql} INNER JOIN;`                                                      | Возвращает только совпавшие из двух таблиц записи.             | Наиболее частый тип `{sql} JOIN;`                                                                                       |
| `{sql} LEFT JOIN;`                                                       | Все строки из левой + совпавшие из правой таблицы.             | Используется для выборки с "дырами".                                                                                    |
| `{sql} RIGHT JOIN;`                                                      | Все строки из правой + совпавшие из левой таблицы.             | Редко, но полезно при анализе.                                                                                          |
| `{sql} FULL OUTER JOIN;`                                                 | Все строки из обеих таблиц.                                    | Анализ пересечений и различий.                                                                                          |
| `{sql} CROSS JOIN;`                                                      | Декартово произведение (все комбинации).                       | Пример: <br>table a: go, c;<br>table b: func, method;<br><br>join table: go - func, go - method, c - func, c - method;  |
| `{sql} UNION;`                                                           | Объединяет результаты двух `{sql} SELECT` (убирает дубликаты). | Склейка данных.                                                                                                         |
| `{sql} UNION ALL;`                                                       | Объединяет без удаления дубликатов.                            | Быстрее, когда дубликаты допустимы.                                                                                     |
| `{sql} EXCEPT / MINUS;`                                                  | Возвращает строки из первого запроса, которых нет во втором.   | Анализ различий.<br>Оба делают одно и тоже, но в разных sql диалектах: except в pg, minus в mysql.                      |
| `{sql} INTERSECT;`                                                       | Общие строки между запросами.                                  | Пересечение множеств.                                                                                                   |
| `{sql} CASE WHEN ... THEN ... ELSE ... END;`                             | Условная логика.                                               | Аналог `{go} if - else` внутри SQL.                                                                                     |
| `{sql} COALESCE(col, default);`                                          | Возвращает первое ненулевое значение.                          | Замена `{sql} NULL` на дефолт.                                                                                          |
| `{sql} NULLIF(a, b);`                                                    | Возвращает `{sql} NULL`, если значения равны.                  | Удобно для деления на ноль.                                                                                             |
| `{sql} CAST(expr AS type);`                                              | Преобразует тип данных.                                        | Приведение к нужному типу.                                                                                              |
| `{sql} EXTRACT(YEAR FROM date);`                                         | Извлекает часть даты.                                          | Группировка по году, месяцу и т.д.                                                                                      |
| `{sql} DATE_TRUNC('month', date);`                                       | Усечение даты до месяца / года.                                | Для агрегации по периоду.                                                                                               |
| `{sql} NOW() / CURRENT_DATE;`                                            | Текущее время / дата.                                          | Метки создания, фильтрация по времени.                                                                                  |
| `{sql} CREATE INDEX idx_name ON table(col);`                             | Создает индекс.                                                | Ускоряет выборки по полям. <br>Пример : закладки в книге.                                                               |
| `{sql} DROP INDEX idx_name;`                                             | Удаляет индекс.                                                | Очистка ненужных индексов.                                                                                              |
| `{sql} EXPLAIN;`                                                         | Показывает план выполнения запроса.                            | Оптимизация производительности.                                                                                         |
| `{sql} ANALYZE;`                                                         | Обновляет статистику оптимизатора.                             | Улучшение плана запросов.                                                                                               |
| `{sql} BEGIN; / COMMIT; / ROLLBACK;`                                     | Управление транзакциями.                                       | `{sql} BEGIN:` Начинает транзакцию;<br>`{sql} COMMIT:`Фиксирует изменения; <br>`{sql} ROLLBACK:` Откатывает при ошибке. |
| `{sql} SAVEPOINT name;`                                                  | Точка отката внутри транзакции.                                | Частичный `{sql} rollback`.                                                                                             |
| `{sql} CREATE VIEW view_name AS SELECT ...;`                             | Создает виртуальную таблицу (представление).                   | Повторное использование сложных запросов.                                                                               |
| `{sql} DROP VIEW view_name;`                                             | Удаляет представление.                                         | Очистка схемы.                                                                                                          |
| `{sql} WITH cte AS (SELECT ...) SELECT ...;`                             | Common Table Expression (временное имя подзапроса).            | Делает запросы чище и модульнее.                                                                                        |
| `{sql} WINDOW / OVER();`                                                 | Оконные функции.                                               | Расчет рангов, сумм, средних по окну.                                                                                   |
| `{sql} ROW_NUMBER();`                                                    | Присваивает порядковый номер строке.                           | Нумерация записей.                                                                                                      |
| `{sql} RANK() / DENSE_RANK();`                                           | Рейтинг с пропусками / без.                                    | Лидеры, топ-N.                                                                                                          |
| `{sql} LAG() / LEAD();`                                                  | Доступ к предыдущей / следующей строке.                        | Анализ изменений по времени.                                                                                            |
| `{sql} PARTITION BY col;`                                                | Делит данные на группы внутри оконных функций.                 | Например, считать суммы по пользователю.                                                                                |
| `{sql} CREATE FUNCTION name(...) RETURNS ... AS $$ ... $$ LANGUAGE sql;` | Определяет пользовательскую функцию.                           | Логика на уровне БД.                                                                                                    |
| `{sql} CREATE TRIGGER ...;`                                              | Создает триггер на событие.                                    | Автоматизация при `{sql} INSERT / UPDATE / DELETE`.                                                                     |
| `{sql} GRANT SELECT, INSERT ON table TO user;`                           | Выдает права пользователю.                                     | Контроль доступа.                                                                                                       |
| `{sql} REVOKE INSERT ON table FROM user;`                                | Отзывает права.                                                | Безопасность.                                                                                                           |
| `{sql} CREATE ROLE name; / GRANT role TO user;`                          | Роли и группы пользователей.                                   | Управление доступом.                                                                                                    |
| `{sql} BACKUP DATABASE;` (в зависимости от СУБД)                         | Создает резервную копию.                                       | Защита от потери данных.                                                                                                |

---
## Часто используемые комбинации SQL:

| Комбинация                                                                                                       | Назначение / пример применения                        |
| ---------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------- |
| `{sql} SELECT * FROM users WHERE age > 18 ORDER BY created_at DESC LIMIT 10;`                                    | Получить 10 последних совершеннолетних пользователей. |
| `{sql} SELECT COUNT(*), country FROM users GROUP BY country HAVING COUNT(*) > 100;`                              | Страны, где больше 100 пользователей.                 |
| `{sql} SELECT u.name, o.id FROM users u INNER JOIN orders o ON u.id = o.user_id;`                                | Выборка пользователей с заказами.                     |
| `{sql} SELECT name, COALESCE(phone, '—') FROM customers;`                                                        | Подставить дефолт вместо `{sql} NULL`.                |
| `{sql} WITH recent AS (SELECT * FROM orders WHERE created_at > NOW() - INTERVAL '7 days') SELECT * FROM recent;` | CTE для удобства.                                     |
| `{sql} SELECT product, SUM(price) OVER (PARTITION BY category) FROM products;`                                   | Оконная сумма по категориям.                          |
| `{sql} UPDATE users SET active = false WHERE last_login < NOW() - INTERVAL '1 year';`                            | Деактивировать неактивных пользователей.              |
| `{sql} DELETE FROM logs WHERE created_at < NOW() - INTERVAL '90 days';`                                          | Очистить старые логи.                                 |

---
## Продвинутые темы:

| Тема                              | Описание / зачем знать                        |
| --------------------------------- | --------------------------------------------- |
| Индексы (B-Tree, Hash, GIN, GiST) | Оптимизация запросов по типу данных.          |
| Нормализация (1NF-3NF)            | Правильное проектирование схемы.              |
| Денормализация                    | Оптимизация чтения, компромисс ради скорости. |
| Оконные функции                   | Аналитика и сложные расчеты.                  |
| CTE и рекурсивные запросы         | Разбор иерархий, дерева комментариев и т.п.   |
| Транзакции и блокировки           | Безопасная работа с параллельными запросами.  |
| EXPLAIN / ANALYZE                 | Оптимизация медленных запросов.               |
| ACID-свойства                     | Понимание надежности БД.                      |
| MVCC (PostgreSQL)                 | Конкурентность без блокировок.                |
| Права и роли                      | Безопасность и многопользовательская работа.  |

---
